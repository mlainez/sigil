(mod test_polymorphic_ops

(fn test_print ((x i32) (y i64) (z string) (b bool)) -> unit
  (do
    (call print x)
    (call print y)
    (call print z)
    (call print b)
    (ret unit)))

(fn test_array ((arr array)) -> i32
  (do
    (call array_push arr 42)
    (call array_push arr 99)
    (set size (call len arr))
    (call print size)
    (set val (call array_get arr 0))
    (ret val)))

(fn test_string ((s string)) -> i32
  (do
    (set length (call len s))
    (call print length)
    (ret length)))

(fn test_math ((x i32)) -> i32
  (do
    (set result (call add x 10))
    (call print result)
    (ret result)))

(test-spec test_print
  (case "print various types"
    (input 42 100 "hello" true)
    (expect unit)))

(test-spec test_array
  (case "array operations"
    (input (call array_new 10))
    (expect 42)))

(test-spec test_string
  (case "string length"
    (input "hello")
    (expect 5)))

(test-spec test_math
  (case "add"
    (input 5)
    (expect 15)))

)
