(mod test_http
  (fn fetch_url url string -> string
    (ret (call http_get url)))
  
  (test-spec fetch_url
    (case "fetch HTTP 200 status URL"
      (mock (http_get "http://httpbin.org/status/200") "response_object_1")
      (input "http://httpbin.org/status/200")
      (expect "response_object_1")))
  
  (fn get_status_code response string -> int
    (ret (call http_get_status response)))
  
  (test-spec get_status_code
    (case "extract status code from response"
      (mock (http_get_status "response_object_1") 200)
      (input "response_object_1")
      (expect 200)))
  
  (fn get_response_body response string -> string
    (ret (call http_get_body response)))
  
  (test-spec get_response_body
    (case "extract body from response"
      (mock (http_get_body "response_object_1") "")
      (input "response_object_1")
      (expect "")))
  
  (meta-note "Tests HTTP GET operations atomically - fetch URL, get status code, get response body with mocked HTTP calls"))
