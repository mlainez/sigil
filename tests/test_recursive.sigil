(module test
  (fn multiply a int b int -> int
    (ret (mul a b)))
  
  (test-spec multiply
    (case "multiply positive numbers"
      (input 6 7)
      (expect 42))
    (case "multiply by zero"
      (input 5 0)
      (expect 0))
    (case "multiply by one"
      (input 10 1)
      (expect 10))
    (case "multiply negative numbers"
      (input -3 4)
      (expect -12)))
  
  (fn factorial n int -> int
    (if (le n 1)
      (ret 1))
    (set n_minus_1 int (sub n 1))
    (set fact_rest int (factorial n_minus_1))
    (ret (mul n fact_rest)))
  
  (test-spec factorial
    (case "factorial of 5"
      (input 5)
      (expect 120))
    (case "factorial of 0"
      (input 0)
      (expect 1))
    (case "factorial of 1"
      (input 1)
      (expect 1))
    (case "factorial of 3"
      (input 3)
      (expect 6))
    (case "factorial of 4"
      (input 4)
      (expect 24)))
  
  (meta-note "Tests recursive factorial function using if statements and multiply operation"))