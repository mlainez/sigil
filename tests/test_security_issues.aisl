(mod security_test
  (fn vulnerable_query ((user_input string)) -> string
    ; SQL Injection vulnerability - using string concatenation
    (set query string (call str_concat "SELECT * FROM users WHERE id = " user_input))
    (call sql_query query)
    (ret query))
  
  (fn weak_crypto ((data string)) -> string
    ; Weak cryptography - using MD5
    (set hashed string (call md5_hash data))
    (ret hashed))
  
  (fn hardcoded_secret () -> string
    ; Hardcoded credentials
    (set password string "admin123")
    (set api_key string "sk_live_abc123xyz789")
    (ret api_key))
  
  (fn command_injection ((filename string)) -> unit
    ; Command injection - using string concatenation
    (set cmd string (call str_concat "rm " filename))
    (call shell_exec cmd)
    (ret))
  
  (fn path_traversal ((user_path string)) -> string
    ; Path traversal vulnerability
    (set full_path string (call str_concat "/var/data/" user_path))
    (call file_read full_path)
    (ret full_path))
  
  (fn xss_vulnerability ((user_html string)) -> string
    ; XSS vulnerability - unescaped HTML
    (set output string (call str_concat "<div>" user_html))
    (call http_send_html output)
    (ret output))
)
