(module test_replace
  (import string_utils)
  (fn do_replace text string old_str string new_str string -> string
    (ret (replace text old_str new_str)))
  
  (test-spec do_replace
    (case "replace world with Sigil"
      (input "hello world" "world" "Sigil")
      (expect "hello Sigil"))
    (case "replace all foo with X"
      (input "foo bar foo baz foo" "foo" "X")
      (expect "X bar X baz X"))
    (case "replace spaces with dashes"
      (input "a b c" " " " - ")
      (expect "a - b - c"))
    (case "remove all dashes"
      (input "remove-all-dashes" "-" "")
      (expect "removealldashes"))
    (case "no match returns original"
      (input "hello" "xyz" "ABC")
      (expect "hello")))
  
  (meta-note "Tests replace for pattern replacement"))
