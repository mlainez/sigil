(module test_decimal_comprehensive
  (fn decimal_negative_add_test a int b int expected int -> bool
    (set da decimal (cast_int_decimal a))
    (set db decimal (cast_int_decimal b))
    (set sum decimal (add da db))
    (set result_int int (cast_decimal_int sum))
    (set matches bool (eq result_int expected))
    (ret matches))
  
  (fn decimal_mul_test a int b int expected int -> bool
    (set da decimal (cast_int_decimal a))
    (set db decimal (cast_int_decimal b))
    (set product decimal (mul da db))
    (set result_int int (cast_decimal_int product))
    (set matches bool (eq result_int expected))
    (ret matches))
  
  (test-spec decimal_negative_add_test
    (case "adds negative and positive"
      (input -5 10 5)
      (expect true))
    (case "adds two negatives"
      (input -5 -3 -8)
      (expect true)))
  
  (test-spec decimal_mul_test
    (case "multiplies negative by positive"
      (input -5 10 -50)
      (expect true))
    (case "handles large numbers"
      (input 999999 2 1999998)
      (expect true)))
  
  (meta-note "Comprehensive decimal tests: negatives, large numbers, edge cases"))