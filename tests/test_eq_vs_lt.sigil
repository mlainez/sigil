(module test_eq_in_if
  (fn test_with_lt x int -> string
    (set check bool (lt x 50))
    (if check
      (ret "less than 50"))
    (ret "50 or more"))
  
  (fn test_with_eq x int -> string
    (set check bool (eq x 100))
    (if check
      (ret "equals 100"))
    (ret "not 100"))
  
  (test-spec test_with_lt
    (case "returns 'less than 50' for small numbers"
      (input 10)
      (expect "less than 50"))
    (case "returns '50 or more' for large numbers"
      (input 60)
      (expect "50 or more"))
    (case "returns '50 or more' for exactly 50"
      (input 50)
      (expect "50 or more")))
  
  (test-spec test_with_eq
    (case "returns 'equals 100' for 100"
      (input 100)
      (expect "equals 100"))
    (case "returns 'not 100' for 99"
      (input 99)
      (expect "not 100"))
    (case "returns 'not 100' for 101"
      (input 101)
      (expect "not 100")))
  
  (meta-note "Tests using eq vs lt in conditional checks"))
