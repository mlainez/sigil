(mod test
  (fn map_ops_length -> int
    (ret (call map_length (call map_set (call map_set (call map_set (call map_new) "a" 100) "b" 200) "c" 300))))
  
  (test-spec map_ops_length
    (case "three entries"
      (input)
      (expect 3)))
  
  (fn map_has_key key string -> bool
    (ret (call map_has (call map_set (call map_set (call map_new) "a" 100) "b" 200) key)))
  
  (test-spec map_has_key
    (case "has key a"
      (input "a")
      (expect 1))
    (case "has key b"
      (input "b")
      (expect 1))
    (case "does not have key x"
      (input "x")
      (expect 0)))
  
  (fn map_delete_then_length -> int
    (ret (call map_length (call map_delete (call map_set (call map_set (call map_set (call map_new) "a" 100) "b" 200) "c" 300) "b"))))
  
  (test-spec map_delete_then_length
    (case "delete one entry"
      (input)
      (expect 2)))
  
  (fn map_delete_then_has key string -> bool
    (ret (call map_has (call map_delete (call map_set (call map_new) "b" 200) "b") key)))
  
  (test-spec map_delete_then_has
    (case "deleted key b not present"
      (input "b")
      (expect 0)))
  
  (meta-note "Tests map operations: new, set, get, length, has, delete"))