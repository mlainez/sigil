(module test_string_ext
  (import string_utils)
  (fn check_starts_with msg string prefix string -> bool
    (ret (starts_with msg prefix)))
  
  (test-spec check_starts_with
    (case "starts with Hello"
      (input "Hello World" "Hello")
      (expect true))
    (case "does not start with World"
      (input "Hello World" "World")
      (expect false)))
  
  (fn check_ends_with msg string suffix string -> bool
    (ret (ends_with msg suffix)))
  
  (test-spec check_ends_with
    (case "ends with World"
      (input "Hello World" "World")
      (expect true))
    (case "does not end with Hello"
      (input "Hello World" "Hello")
      (expect false)))
  
  (fn do_to_upper msg string -> string
    (ret (to_upper msg)))
  
  (test-spec do_to_upper
    (case "convert to uppercase"
      (input "Hello World")
      (expect "HELLO WORLD"))
    (case "already uppercase"
      (input "TEST")
      (expect "TEST")))
  
  (fn do_to_lower msg string -> string
    (ret (to_lower msg)))
  
  (test-spec do_to_lower
    (case "convert to lowercase"
      (input "Hello World")
      (expect "hello world"))
    (case "already lowercase"
      (input "test")
      (expect "test")))
  
  (meta-note "Tests string extension functions: starts_with, ends_with, to_upper, to_lower"))
